<div class="schedule-day-filterItem">
    <span class="js-schedule-filterDay schedule-day-filter schedule-day fullSchedule-day schedule-dayAll" data-day='all' onclick="showDay(this, 'all')">&{'views.application.schedule.allDays'}</span>
</div>
#{list items: _days, as: 'day'}
    <div class="schedule-day-filterItem">
        <span class="js-schedule-filterDay schedule-day-filter schedule-day-filter--hidden schedule-day fullSchedule-day schedule-day${day_index}" data-day='${day_index}' onclick="showDay(this, '${day_index}')">${day.format('EEEE dd MMMM yyyy')}</span>
    </div>
#{/list}

#{list items: _days, as: 'day'}

    %{tracks = _tracksPerDays.get(day);}%
    
    <div class="js-schedule-day" data-day='${day_index}'>
        <h2 class="schedule-day fullSchedule-day schedule-day${day_index}">${day.format('EEEE dd MMMM yyyy')}</h2>

        <table class="fullSchedule">
            
            #{list items: models.Slot.findPerDay(day), as: 'slot'}
                <tr>
                    <td class="fullSchedule__time">
                        <span>${slot.startDate.format('HH:mm')}</span>
                        #{if _user}
                            <a class="fullSchedule__admin" href="@{Slots.show(slot.id)}">edit</a>
                        #{/if}
                    </td>
                </tr>

                %{allTracksEvent = slot.allTracksEvent}%
                #{if allTracksEvent } <!-- One talk for all tracks -->
                    <tr>
                        <td class="fullSchedule__${allTracksEvent.isBreak.code}">
                            #{if allTracksEvent.isBreak != models.BreakType.NotABreak}
                                <span class="fullSchedule__breakTitle">${allTracksEvent.title}</span>
                            #{/if}
                            #{else}
                                <!-- If it's not a break, it should have a track assigned -->
                            #{/else}
                            #{if _user}
                                <a class="fullSchedule__admin" href="@{Talks.show(allTracksEvent.id)}">edit</a>
                            #{/if}
                        </td>
                    </tr>
                #{/if}
                #{else}
                    #{list items: tracks, as: 'track'}
                        %{talk = slot.getTalkPerTrack(track);}%
                        #{if talk}
                            <tr>
                                <td class="js-talksFilter-toFilter fullSchedule-talk-cell">
                                
                                    #{if !talk.isHiddenInTalksPage}
                                        <a href="@{Application.talk(talk.id)}"
                                            class="fullSchedule__talk__item
                                                    fullSchedule__talk__item--link
                                                    talksFilter-item
                                                    js-talksFilter-item
                                                    js-talksFilter-theme-${talk.theme?.theme?.slugify()} 
                                                    js-talksFilter-level-${talk.level?.code}
                                                    js-talksFilter-type-${talk.type?.toString()?.slugify()}
                                                    js-talksFilter-language-${talk.language?.toString()?.slugify()}">

                                            <div class="fullSchedule__talk__part1">
                                                <div class="fullSchedule__talk__title" >${talk.title}</div>

                                                <div class="fullSchedule__talk__slotTrack">
                                                    <div class="fullSchedule__talk__slot">
                                                        ${talk.slot.startDate.format('HH:mm')} - ${talk.slot.endDate.format('HH:mm')}
                                                    </div>
                                                    <span class="fullSchedule__talk__track">
                                                        ${track.title}
                                                    </span>
                                                </div>

                                                <div class="fullSchedule__talk__infos">
                                                    #{if talk.theme}
                                                        <div class="fullSchedule__talk__theme">${talk.theme}</div>
                                                    #{/if}

                                                    #{if talk.type}
                                                        <div class="fullSchedule__talk__type">${talk.type}</div>
                                                    #{/if}        
                                                    #{if talk.level}
                                                        <div class="fullSchedule__talk__level">&{'views.application.schedule.level.' + talk.level.code}</div>
                                                    #{/if}
                                                    #{if talk.language}
                                                        <div class="fullSchedule__talk__language" aria-label="&{'views.application.schedule.language.' + talk.language}">
                                                            ${talk.language}
                                                        </div>
                                                    #{/if}
                                                </div>
                                            </div>

                                            <div class="fullSchedule__talk__part2 fullSchedule__talk__part2--${talk.theme ? talk.theme.color.code : 'none'}">
                                                <ul class="fullSchedule__talk__speakers">
                                                    #{list items: talk.speakers, as: 'speaker'}
                                                        <li class="fullSchedule__talk__speaker">
                                                            <div
                                                                class="fullSchedule__talk__speakerPhoto"
                                                                style="background-image: url('@{Application.speakerPhoto(speaker.id)}')"
                                                            ></div>
                                                            <span class="fullSchedule__talk__speakerName" href="@{Application.speaker(speaker.id)}">
                                                                ${speaker.firstName} ${speaker.lastName}
                                                            </span>
                                                        </li>
                                                    #{/list}
                                                </ul>

                                                <div class="fullSchedule__talk__like js-talksFilter-like" data-talk="${talk.id}" onclick="event.preventDefault(); likeTalk(this,'${talk.id}')">
                                                    #{if _user}
                                                        <span class="fullSchedule__talk__nbLikes">${talk.nbLikes}</span>
                                                    #{/if}
                                                    <i class="far fa-heart"></i>
                                                </div>
                                            </div>
                                        </div>
                                    #{/if}
                                    #{else}
                                        <div class="fullSchedule__talk__item js-fullSchedule-talk-item fullSchedule__talk__part">
                                            <span class="fullSchedule__talk__title">${talk.title}</span>
                                        </div>
                                    #{/else}
                                </td>
                            </tr>
                        #{/if}
                    #{/list}
                #{/else}
            
            #{/list}
            #{if _user}
                <tr>
                    <td><a href="@{Slots.blank()}">add slot</a></td>
                </tr>
            #{/if}
            
        </table>
        
    </div>
#{/list}